<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Lie Detection Survey</title>
    <style>
        /* Global styles */
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            font-family: Arial, sans-serif;
        }

        /* Section specific styles */
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            margin-bottom: 20px;
        }

        .instructions {
            background-color: #f9f9f9; /* Light grey background */
            margin: 20px auto;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Soft shadow for depth */
            width: 80%; /* Responsive width */
            max-width: 800px; /* Maximum width */
        }

        .iframe-container {
    width: 100%;
    max-width: 640px;
    margin: 0 auto;
    overflow: hidden; /* This will remove the scrollbar if the iframe fits */
}

.iframe-container iframe {
    width: 100%;
    min-height: 1200px; /* You can adjust this value as needed */
    border: none;
}

        ol {
            text-align: left;
        }

        /* Added styles for session key and copy button */
        #session-key {
            font-weight: bold;
            margin: 10px 0;
            padding: 10px;
            background-color: #e7e7e7;
            display: inline-block;
            border: 1px solid #ccc;
        }

        #copy-button {
            cursor: pointer;
            padding: 10px;
            margin-left: 10px;
            background-color: #673b03;
            color: white;
            border: none;
            border-radius: 5px;
        }

        #session-key-box {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
            margin: 20px auto;
            width: 80%;
            max-width: 600px;
        }

        #session-key-label {
            display: block;
            margin-bottom: 10px;
            font-size: 1.1em;
            font-weight: bold;
        }

        .speaker-info {
            background-color: #fff; /* White background */
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin: 20px auto;
            text-align: center;
            width: 80%;
            max-width: 300px; /* Adjust as needed */
            font-size: 0.9em;
        }

        .speaker-info img {
            max-width: 100%;
            height: auto;
            border-radius: 4px;
        }

        /* Additional styles for audio navigation */
        .audio-nav-container {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #prev-button, #next-button {
            padding: 10px 20px;
            margin: 0 10px;
            background-color: #673b03;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em; /* Match font size with audio control */
        }

        #prev-button:disabled, #next-button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        .audio-container {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
            margin: 20px auto;
            width: 80%;
            max-width: 600px; /* Adjust this value to fit the content as you like */
        }

        .audio-nav-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 20px; /* Adds some space between the speaker-info and the audio controls */
        }
        /* Style for introduction section */
        .introduction {
            background-color: #f9f9f9; /* Light grey background */
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
            margin: 20px auto;
            width: 80%;
            max-width: 700px; /* Adjust as needed for your design */
        }

        /* Adjustments for audio control to fit with the buttons */
        audio {
            margin: 0 15px; /* Add margin to give space between buttons and audio control */
        }

        /* Mobile responsiveness */
        @media (max-width: 768px) {
            .container, .introduction, .instructions, .audio-container {
                width: 95%; /* Full width with a little margin on mobile */
                max-width: none; /* Allow it to stretch on smaller screens */
            }

            .audio-nav-container button {
                padding: 8px 16px; /* Slightly smaller buttons on mobile */
            }
        }

    </style>
</head>
<body>

    <header class="container">

    <!-- Introduction Section -->
    <div class="container introduction">
        <h2>Welcome to the Lie Detection Survey</h2>
        <p>You will listen to eight statements spoken by different speakers. Your task is to assess which statements are true and which are false, and rank your confidence in each response. Please pay close attention to each statement and complete the survey accordingly.</p>
    </div>

        <div class="instructions">
            <p>Please carefully read and follow the instructions below to ensure your participation is recorded correctly:</p>
            <ol>
                <li><strong>Session Key</strong>: Locate your unique session key provided below. You will need this to complete the survey. To copy it:
                    <ul>
                        <li>Select the key and press <code>Ctrl + C</code> (or <code>Cmd + C</code> on Mac) to copy it to your clipboard.</li>
                        <li>Alternatively, you can click the "Copy" button next to the session key.</li>
                    </ul>
                </li>
                <li><strong>Enter Personal Details</strong>: Scroll down to the survey section and enter your personal details on the first page of the survey form. Click "Next" to proceed.</li>
                <li><strong>Listen to Audio Clips</strong>: You will find audio clips labeled (e.g., "Audio 1", "Audio 2", etc.). Please listen to each clip in order by pressing the "Play" button.</li>
                <li><strong>Answer Questions</strong>: After listening to each audio clip, answer the corresponding question about the clip in the survey. Once you have answered, click "Next" to move on to the next audio clip and set of questions.</li>
                <li><strong>Complete All Sections</strong>: Continue this process for all audio clips provided.</li>
                </li>
            </ol>
            <p>Thank you for your time and valuable input. Your participation is greatly appreciated!</p>
        </div>
        <!-- Session key section -->
        <div id="session-key-box">
            <span id="session-key-label">Your Session Key:</span>
            <span id="session-key"></span>
            <button id="copy-button">Copy</button>
            <p>Remember to copy and paste your session key into the form below. WARNING: If you reload or exit the page - you must paste your new session key into the form and restart from Audio 1. Do NOT fill anything in to the "ExtendedForms Id" field, it is required for tracking your responses.</p>
        </div>
    </header>

    <main class="container">
        <section id="audio-files">
            <div class="audio-container">
                <h2 id="audio-title">Listen to Audio 1</h2>
                <div class="speaker-info">
                    <img id="speaker-image" src="Resources/0.png" alt="Speaker Information">
                </div>
                <div class="audio-nav-container">
                    <button id="prev-button">Previous</button>
                    <audio id="audio-player" controls>
                        <source id="audio-source" src="Resources/0.mp3" type="audio/mpeg">
                        Your browser does not support the audio element.
                    </audio>
                    <button id="next-button">Next</button>
                </div>
            </div>
        </section>
    </main>

    <div class="iframe-container">
        <iframe src="https://docs.google.com/forms/d/e/1FAIpQLScK6IVbqYyfe16CQ4vuYzMZU9tRI-hDXj2UXd88Yw2r5S7i4Q/viewform?embedded=true" frameborder="0" marginheight="0" marginwidth="0">Loadingâ€¦</iframe>

        <script>
            function shuffle(array) {
                var currentIndex = array.length, temporaryValue, randomIndex;
                while (currentIndex !== 0) {
                    randomIndex = Math.floor(Math.random() * currentIndex);
                    currentIndex -= 1;
                    temporaryValue = array[currentIndex];
                    array[currentIndex] = array[randomIndex];
                    array[randomIndex] = temporaryValue;
                }
                return array;
            }
        
            document.addEventListener('DOMContentLoaded', function() {
                // Mappings for speaker codes to gender and country
                const speakerMapping = {
                    a: 'FF', // Female, French
                    b: 'FM', // Male, French
                    c: 'SF', // swiss female
                    d: 'SM', // swiss male
                    e: 'CF', // chinese female
                    f: 'CM', // chinese male
                    g: 'MF', // Morrocan female
                    h: 'MM'  // Morrocan male
                };
        
                // Generate random session key for texts and speakers
                var textSequence = shuffle([0, 1, 2, 3, 4, 5, 6, 7]);
                var speakerSequence = shuffle(['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h']);
        
                // Create session key from shuffled sequences
                var sessionKey = textSequence.map(i => i.toString()).join('') + speakerSequence.join('');
                var sessionKeyElement = document.getElementById('session-key');
                sessionKeyElement.textContent = sessionKey;
        
                var audioIndex = 0;
                function updateAudioPlayer() {
                    var currentText = textSequence[audioIndex] + 1; // Text number (add 1 for filename)
                    var currentSpeakerChar = speakerSequence[audioIndex];
                    var speakerCode = speakerMapping[currentSpeakerChar];
        
                    var audioFileName = `${currentText}${speakerCode}.mp3`;
                    var audioSource = document.getElementById('audio-source');
                    var speakerImage = document.getElementById('speaker-image');
                    var audioTitle = document.getElementById('audio-title');
        
                    audioSource.src = `Resources/${audioFileName}`;
                    speakerImage.src = `Resources/${speakerCode}.png`;
                    audioTitle.textContent = `Listen to Audio ${audioIndex + 1}`;
        
                    var audioPlayer = document.getElementById('audio-player');
                    audioPlayer.load();
                }
        
                // Initial audio setup
                updateAudioPlayer();
        
                // Button controls for navigation
                var prevButton = document.getElementById('prev-button');
                var nextButton = document.getElementById('next-button');
        
                prevButton.addEventListener('click', function() {
                    if (audioIndex > 0) {
                        audioIndex--;
                        updateAudioPlayer();
                        nextButton.disabled = false;
                    }
                    prevButton.disabled = audioIndex === 0;
                });
        
                nextButton.addEventListener('click', function() {
                    if (audioIndex < 7) { // Limit to 8 audios
                        audioIndex++;
                        updateAudioPlayer();
                        prevButton.disabled = false;
                    }
                    nextButton.disabled = audioIndex === 7;
                });
        
                // Copy session key function
                document.getElementById('copy-button').addEventListener('click', function() {
                    navigator.clipboard.writeText(sessionKey).then(function() {
                        alert('Session key copied to clipboard!');
                    }, function(err) {
                        alert('Error copying the session key. Please try again.');
                    });
                });
            });
        </script>        
    </body>
</html>
