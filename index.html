<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Lie Detection Survey</title>
    <style>
        /* Global styles */
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            font-family: Arial, sans-serif;
        }

        /* Section specific styles */
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            margin-bottom: 20px;
        }

        .instructions {
            background-color: #f9f9f9; /* Light grey background */
            margin: 20px auto;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Soft shadow for depth */
            width: 80%; /* Responsive width */
            max-width: 800px; /* Maximum width */
        }

        .iframe-container {
            width: 100%;
            max-width: 640px;
            margin: 0 auto;
        }

        iframe {
            width: 100%;
            height: 776px; /* Adjust as necessary */
            border: 0;
        }

        ol {
            text-align: left;
        }

        /* Added styles for session key and copy button */
        #session-key {
            font-weight: bold;
            margin: 10px 0;
            padding: 10px;
            background-color: #e7e7e7;
            display: inline-block;
            border: 1px solid #ccc;
        }

        #copy-button {
            cursor: pointer;
            padding: 10px;
            margin-left: 10px;
            background-color: #673b03;
            color: white;
            border: none;
            border-radius: 5px;
        }

        #session-key-box {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
            margin: 20px auto;
            width: 80%;
            max-width: 600px;
        }

        #session-key-label {
            display: block;
            margin-bottom: 10px;
            font-size: 1.1em;
            font-weight: bold;
        }

        .speaker-info {
            background-color: #fff; /* White background */
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin: 20px auto;
            text-align: center;
            width: 80%;
            max-width: 300px; /* Adjust as needed */
            font-size: 0.9em;
        }

        .speaker-info img {
            max-width: 100%;
            height: auto;
            border-radius: 4px;
        }

        /* Additional styles for audio navigation */
        .audio-nav-container {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #prev-button, #next-button {
            padding: 10px 20px;
            margin: 0 10px;
            background-color: #673b03;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em; /* Match font size with audio control */
        }

        #prev-button:disabled, #next-button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        .audio-container {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
            margin: 20px auto;
            width: 80%;
            max-width: 600px; /* Adjust this value to fit the content as you like */
        }

        .audio-nav-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 20px; /* Adds some space between the speaker-info and the audio controls */
        }

/* Adjustments for audio control to fit with the buttons */
audio {
    margin: 0 15px; /* Add margin to give space between buttons and audio control */
}

    </style>
</head>
<body>

    <header class="container">
        <h1>Welcome to the lie detection survey!</h1>

        <div class="instructions">
            <p>Welcome to our survey. Please carefully read and follow the instructions below to ensure your participation is recorded correctly:</p>
            <ol>
                <li><strong>Session Key</strong>: Locate your unique session key provided below. You will need this to complete the survey. To copy it:
                    <ul>
                        <li>Select the key and press <code>Ctrl + C</code> (or <code>Cmd + C</code> on Mac) to copy it to your clipboard.</li>
                        <li>Alternatively, you can click the "Copy" button next to the session key.</li>
                    </ul>
                </li>
                <li><strong>Enter Personal Details</strong>: Scroll down to the survey section and enter your personal details on the first page of the survey form. Click "Next" to proceed.</li>
                <li><strong>Listen to Audio Clips</strong>: You will find audio clips labeled (e.g., "Audio 1", "Audio 2", etc.). Please listen to each clip in order by pressing the "Play" button.</li>
                <li><strong>Answer Questions</strong>: After listening to each audio clip, answer the corresponding question about the clip in the survey. Once you have answered, click "Next" to move on to the next audio clip and set of questions.</li>
                <li><strong>Complete All Sections</strong>: Continue this process for all audio clips provided.</li>
                </li>
            </ol>
            <p>Thank you for your time and valuable input. Your participation is greatly appreciated!</p>
        </div>
        <!-- Session key section -->
        <div id="session-key-box">
            <span id="session-key-label">Your Session Key:</span>
            <span id="session-key"></span>
            <button id="copy-button">Copy</button>
            <p>Remember to copy and paste your session key into the form below. Warning: If you reload or exit the page - you must paste your new session key into the form and restart from Audio 1.</p>
        </div>
    </header>

    <main class="container">
        <section id="audio-files">
            <div class="audio-container">
                <h2 id="audio-title">Listen to Audio 1</h2>
                <div class="speaker-info">
                    <img id="speaker-image" src="Resources/0.png" alt="Speaker Information">
                </div>
                <div class="audio-nav-container">
                    <button id="prev-button">Previous</button>
                    <audio id="audio-player" controls>
                        <source id="audio-source" src="Resources/0.mp3" type="audio/mpeg">
                        Your browser does not support the audio element.
                    </audio>
                    <button id="next-button">Next</button>
                </div>
            </div>
        </section>
    </main>

    <div class="iframe-container">
        <iframe src="https://docs.google.com/forms/d/e/1FAIpQLScK6IVbqYyfe16CQ4vuYzMZU9tRI-hDXj2UXd88Yw2r5S7i4Q/viewform?embedded=true" width="640" height="1200" frameborder="0" marginheight="0" marginwidth="0">Loadingâ€¦</iframe>    </div>

    <script>
        // Function to shuffle an array
        function shuffle(array) {
            var currentIndex = array.length, temporaryValue, randomIndex;
            // While there remain elements to shuffle...
            while (currentIndex !== 0) {
                // Pick a remaining element...
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex -= 1;
                // And swap it with the current element.
                temporaryValue = array[currentIndex];
                array[currentIndex] = array[randomIndex];
                array[randomIndex] = temporaryValue;
            }
            return array;
        }
    
        // Function to copy the session key to the clipboard
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(function() {
                // Success message
                alert('Session key copied to clipboard!');
            }, function(err) {
                // Error message
                alert('Error copying the session key. Please try again.');
            });
        }
    
        // On page load
        document.addEventListener('DOMContentLoaded', function() {
            var audioSequence = shuffle([0, 1, 2, 3, 4, 5, 6, 7]);
            var audioIndex = 0; // This will be used to iterate over the audioSequence array
            var sessionKey = audioSequence.map(n => n + 1).join(''); // Adding 1 to match the file names
            var sessionKeyElement = document.getElementById('session-key');
            var audioTitle = document.getElementById('audio-title');
            var audioPlayer = document.getElementById('audio-player');
            var audioSource = document.getElementById('audio-source');
            var speakerImage = document.getElementById('speaker-image');
            var prevButton = document.getElementById('prev-button');
            var nextButton = document.getElementById('next-button');
    
            // Update the session key display
            sessionKeyElement.textContent = sessionKey;
    
            // Copy button event listener
            document.getElementById('copy-button').addEventListener('click', function() {
                copyToClipboard(sessionKeyElement.textContent);
            });
    
            // Update the audio player and speaker image based on the session key
            function updateAudioPlayer() {
                var audioFileIndex = audioSequence[audioIndex];
                audioSource.src = 'Resources/' + audioFileIndex + '.mp3';
                speakerImage.src = 'Resources/' + audioFileIndex + '.png';
                audioTitle.textContent = 'Listen to Audio ' + (audioIndex + 1);
                audioPlayer.load();
            }
    
            // Initialize the audio player with the first audio file
            updateAudioPlayer();
    
            // Event listeners for next and previous buttons
            prevButton.addEventListener('click', function() {
                if (audioIndex > 0) {
                    audioIndex--;
                    updateAudioPlayer();
                    nextButton.disabled = false;
                }
                if (audioIndex === 0) {
                    prevButton.disabled = true;
                }
            });
    
            nextButton.addEventListener('click', function() {
                if (audioIndex < audioSequence.length - 1) {
                    audioIndex++;
                    updateAudioPlayer();
                    prevButton.disabled = false;
                }
                if (audioIndex === audioSequence.length - 1) {
                    nextButton.disabled = true;
                }
            });
        });
    </script>

</body>
</html>